\chapter{Metodo del Simplesso}
Il metodo del simplesso è una pocedura algebrica che si basa su dei \emph{concetti geometrici}.
\paragraph{Alcuni Termini}
Questo metodo si basa su alcune terminologie che ci servono per capire come funziona.
Definiamo quindi:
\begin{itemize}
    \item \textbf{Frontiera del vincolo}: è la "linea" di demarcazione di un vincolo.
    \item \textbf{Vertice}: un vertice è un punto di intersezione di coppie di frontiere di vincoli.
          \begin{itemize}
              \item \textbf{Vertici Adiacenti}: Due vertici si dicono adiacenti se condividono $n-1$ frontiere di vincoli.
              \item \textbf{Spigolo}: segmento che collega due vertici adiacenti
          \end{itemize}
    \item \textbf{Vertice Ammissibile}: Un vertice è detto ammissibile se \emph{fa parte} della regione ammissibile
    \item \textbf{Vertice \emph{non} ammissibile}: Un vertice è detto \emph{non} ammissibile se \emph{non} fa parte della regione ammissibile.
\end{itemize}

\paragraph{Test di Ottimalità}
L'interesse per i \emph{vertici adiacenti} sta nella seguente proprietà di cui godono:
\definizione{
    Si consideri ogni problema di PL tale da ammettere almeno una soluzione ottimale:
    \\Se una soluzione vertice non ammette soluzioni vertice a egli adiacenti con valore della funzione obiettivo
    migliore, allora la \textbf{soluzione} in questione è \textbf{ottimale}.
}

\begin{center}
    \includegraphics[width=0.8\textwidth]{img/Simplesso1.jpg}
\end{center}

\section{La Procedura Algebrica}
Il metodo del simplesso è utilizzabile sia in forma algebrica che geometrica.
Siccome questo algoritmo è usualmente eseguito su un calcolatore, che è in grado di interpretare solo istruzioni algebriche,
è necessario tradurre la procedura geometrica in una procedura algebrica, che si basa sulla risoluzione di un sistema di equazioni lineari.
\paragraph{Forma Aumentata}
Per usare il metodo del simplesso bisogna trasformare il modello dalla \emph{forma standard} alla \emph{forma aumentata}:
\\Per fare ciò bisogna fare le seguenti operazioni:
\begin{enumerate}
    \item Trasformo tutti i vincoli (tranne quelli di non negatività) in vincoli di \emph{eguaglianza}:
          $ x_1 +  x_2 \leq 5 \to  x_1 + x_2 = 5$
    \item Per ogni vincolo aggiungo una \textbf{Variabile di Slack}
          \\Ogni vincolo riceve una variabile di slack unica, quindi se abbiamo:
          \[
              \begin{cases}
                  x_1 \leq 3 \\
                  x_2 \leq 2 \\
                  x_1 + x_2 \leq 5
              \end{cases}
              \to
              \begin{cases}
                  x_1 + x_3 = 3 \\
                  x_2 + x_4= 2  \\
                  x_1 + x_2 + x_5 = 5
              \end{cases}
          \]
          $x_3,x_4,x_5$ sono le \emph{variabili di slack}.
          Assumendo che $x_1 = 0$, la variabile di slack $x_3$ è la \emph{quantità che manca al termine sinistro della diseguaglianza,
              affinchè questa sia verificata con il segno di uguaglianza. }
\end{enumerate}
Le variabili di slack hanno alcune proprietà che sono utili da tenere a mente:
Per un qualunque valore delle variabili decisionali:
\begin{itemize}
    \item Se $slack = 0 \implies$ La soluzione corrispondente giace sulla frontiera del vincolo della forma originale.
    \item Se $slack > 0 \implies$ La soluzione corrispondente giace sul lato ammissibile della frontiera del vincolo della forma originale.
    \item Se $slack < 0 \implies$ La soluzione corrispondente giace sul lato NON ammissibile della frontiera del vincolo.
\end{itemize}
Si definisce \textbf{Soluzione Aumentata} una soluzione del modello in forma originale che viene \emph{aumentata} tramite i
corrispondenti valori delle variabili di slack.

\subparagraph{Soluzione di Base}
Si definisce soluzione di base, un vertice del modello in forma aumentata.
\\Se abbiamo come variabili di base $x_1=4,x_2=6$ e come variabili di slack $x_2=0,x_3=0,x_4=-6$ allora la soluzione di base (non ammissibile) associata sarà $(4,6,0,0,-6)$.
\subsection{Variabili di Base e Non}
Un modello in forma aumentata consiste di $d$ variabili decisionali e $s$ variabili di slack.
Abbiamo quindi a disposizione $d$ gradi di libertà per risolvere il sistema lineare.
In altre parole, quando risolviamo un sistema lineare (ponendo a zero il valore di x variabili scelte arbitrariamente)
abbiamo tante variabili azzerabili quante sono le variabili decisionali.

\paragraph{Proprietà delle Soluzioni di Base}
Una \textbf{soluzione di base} gode delle seguenti proprietà:
\begin{enumerate} %Riformula per capire meglio
    \item Una variabile può essere \emph{Di base} o \emph{NON di base}
    \item Il numero delle variabili di base \emph{eguaglia il numero dei vincoli funzionali},
          Di conseguenza il numero delle variabili non di base eguaglia il numero totale delle variabili, meno il numero dei vincoli funzionali
    \item Le variabili NON di base \emph{vengono poste a zero}
    \item I valori delle variabili di base sono ottenuti come risoluzione simultanea del sistema di equazioni lineari (in forma aumentata).
    \item Se le variabili di base soddisfano i vincoli di non negatività, la soluzione di base è una soluzione ammissibile di base.
\end{enumerate}
\paragraph{Soluzioni di Base Adiacenti}
Due soluzioni di base ammissibili sono \emph{adiacenti} se sono caratterizzate dal \textbf{condividere le stesse variabili non di base eccetto una}.
\\Di conseguenza, muoversi da una soluzione di base ammissibile ad una soluzione ad essa adiacente
\emph{Implica che una variabile non di base divenga di base} e che \emph{una variabile di base divenga non di base}.
Il che richiede di aggiustare i valori delle variabili di base per garantire che il sistema di equazioni sia ancora soddisfatto.

\section{I Tableau: un Cheatsheet}
Ricordiamo il problema in forma standard:
\begin{center} %Forma standard
    max $\underline{c}^T$ $\underline{x}$
    \\\underline{\underline{A}} $\underline{x}$ $\leq$ $\underline{b}$
    \\ $\underline{x}$ $\geq 0$
\end{center}
\paragraph*{Tableau}
Il metodo del simplesso è facilmente risolvibile tramite la \emph{Forma Tabellare}.
\paragraph{1 - La forma aumentata}
Per portare il problema in Forma Aumentata:
\begin{itemize}
    \item Vincoli
    \begin{itemize}
        \item \textbf{MinoreUguale }$\leq \to = \wedge$ + SLACK
        \item \textbf{Uguale} $= \to $ INVARIATO
        \item \textbf{MaggioreUguale} $\geq \to = \wedge$ - SURPLUS
    \end{itemize}
    \item Se ho una variabile non positiva: $x_i \leq 0\to$ $x_i' = -x_i$, con $x_i' \geq 0$  
\end{itemize}
\paragraph*{2 - Porto in forma Tabellare}
Il problema in forma aumentata viene riscritto in forma tabellare.
\\ATTENZIONE PERÒ: La funzione obiettivo passa da 
$z = \underline{c}^T \underline{x}$ diventa $z -( \underline{c}^T \underline{x}) = 0$
(Quindi la funzione obiettivo diventa Z meno i coefficenti delle variabili).
\begin{center}
    \begin{tabular}{|c|c|c|cccc|c|}
        \hline
        \small{V. BASE} & Eq    & Z & $x_1$ & $x_2$ & ... & $x_n$ & T. Noto \\
        \hline
        Z       & R$_0$ & 1 & $c_1$ &  $c_2$     &  ...   & $c_n$      &    0     \\
        $x_1$   & R$_1$ & 0 & $a_{11}$      &  $a_{12}$      &  ...   &  $a_{1n}$      &    $b_1$     \\
        $x_m$   & R$_n$ & 0 & $a_{m1}$    & $a_{m2}$       &  ...   &    $a_{mn}$    &      $b_m$   \\
        \hline
    \end{tabular}
\end{center}


\section{Il Metodo dele Due Fasi}

In alcuni problemi di PL il punto $(0,0)$, ovvero l'origine, non è una soluzione ammissibile,
quindi non può essere usata come \emph{Soluzione Ammissibile di Base} per il Metodo Del Simplesso.
\\Quando ci troviamo di fronte a questa situazione abbiamo due possibilità: Usare il meotodo Big M (che non vedremo) oppure usare il \emph{Metodo delle due Fasi}.
\paragraph{Come funziona?}
Con questo metodo si risolve il problema di PL aggiungendo alla forma aumentata una variabile \emph{artificiale} che va ad "annullare" la variabile di slack (prima fase).
La seconda fase consiste nel prendere la soluzione di base generata dalla prima fase e eseguire il metodo del simplesso partendo da li.