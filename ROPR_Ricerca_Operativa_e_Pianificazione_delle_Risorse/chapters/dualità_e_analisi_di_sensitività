\chapter{Dualità e  Analisi di Sensitività}
Ad ogni problema di programmazione lineare, che d'ora in poi chiameremo problema \textbf{Primale}, è associato un problema chiamato \textbf{Duale}. La soluzione ottimale del problema Duale fornisce i \textbf{prezzi ombra} del problema Primale.

\paragraph*{Il Prezzo Ombra}
Il \emph{prezzo ombra} per la risorsa $i-$esima ($y_i^*$) misura il valore marginale della risorsa, cioè, il tasso al quale la funzione obiettivo $z$ potrebbe essere incrementata aumentato (leggermente) la quantità di risorsa $b_i$ disponibile. Il metodo del simplesso identifica il prezzo ombra $y_i^*$ come segue:
\begin{center}
    $y_i^* =$ coefficente della $i-$esima variabile slack nella riga 0 del tableau finale. 
\end{center}
%DA SPOSTARE IN METODO DEL SIMPLESSO
    
\paragraph{Analisi di Sensitività} La teoria della Dualità permette l'implementazione e l'interpretazione dell'analisi di sensitività.
\\L'Analisi di Sensitività è una tecnica che permette di decidere i valori di alcuni parametri di un problema di PL.

\section{Da Primale a Duale}
Un problema duale è strettamente legato al suo primale, infatti per passare da un problema al suo duale:
\begin{center}
\includegraphics[width=0.7\textwidth]{img/dualità1.jpg}
\end{center}

Più in specifico, le regole per Primale$\to$Duale sono:

\begin{center}
    \begin{tabular}{ |l|c|c| }
        \hline
        Funzione Obiettivo:      & max $c_i^Tx$      & min $b^T\lambda$   \\
        \hline \hline
        Vincoli $\leq$ (primale) & $a_i^Tx \leq b_i$ & $\lambda_i \geq 0$ \\
        Vincoli $=$ (primale)    & $a_i^Tx = b_i$    & $\lambda_i$ Libera \\
        Vincoli $\geq$ (primale) & $a_i^Tx \geq b_i$ & $\lambda_i \leq 0$ \\
        \hline
        Vincoli Non negatività   & $x_j\geq 0$       & $A_j^T \geq c_j$   \\
        Variabile Libera         & $x_j$ Libera      & $A_j^T = c_j$      \\
        Vincoli Non positività   & $x_j\leq 0$       & $A_j^T \leq c_j$   \\
        \hline
    \end{tabular}
\end{center}
Quindi dato un qualunque problema di PL:
\begin{itemize}
    \item un problema di MAX diventa un problema di MIN.
    \item i coefficenti del primale diventano i termini noti del duale
    \item i termini noti del primale diventano coefficenti del duale.
    \item i coefficienti di variabile rimangono invariati
\end{itemize}
Si può notare che il Duale di un Duale è il suo Primale, quindi un problema di minimizzazione diventa un problema di massimizzazione.

\section{Teorema della dualità}
Riassumendo le relazioni tra primale e duale, il teorema di dualità dice:
\begin{enumerate}
    \item Se un problema ha soluzioni ammissibili e funzione obiettivo limitata (quindi ha soluzione ottimale), 
    allora la stessa cosa vale per l'altro problema, per cui le proprietà di dualità devole e forte sono entrambe applicabili.
    \item Se un problema ha soluzioni ammissibili e funzione obiettivo Illimitata (non ha ottimo), allora l'altro problema non ha soluzioni ammissibili.
    \item Se un problema ha soluzioni ammissibili, allora l'altro problema o non ha soluzioni ammissibili o ha una funzione obiettivo Illimitata
\end{enumerate}
O, in parole povere:
Se un problema ha:
\begin{itemize}
    \item Sol. Ammissibili, e Ottimo $\implies$ Idem per l'altro (Dualità forte e debole applicabili)
    \item Sol. Ammissibili, e NON Ottimo (obb. illimitata) $\implies$ L'altro NON ha soluzioni ammissibili
    \item No Sol. Ammissibili $\implies$ L'altro o non ha sol. amm. o ha f.obb Illimitata
\end{itemize}

\section{Le condizioni degli Scarti Complementari}
Se ho una soluzione del problema primale e voglio controllare se essa è \textbf{ottima}, posso farlo senza risolvere il problema usando le \emph{Condizioni degli Scarti Complementari}.\\
Le condizioni degli scarti complementari mi permettono, oltre che a controllare se la soluzione del primale in esame sia ottima, anche a \textbf{trovare la soluzione del duale} senza dover usare il metodo del simplesso su di esso.

\subsection{Come funziona}
Se ho una soluzione del primale, controllo che sia ottima e trovo la corrispondente soluzione ottima del duale:

\begin{enumerate}
    \item Controllo che la soluzione in esame sia \textbf{ammissibile per il primale}
    \item applico le \textbf{condizioni degli scarti complementari}:
    \begin{itemize}
        \item Se una variabile della soluzione è \emph{diversa da 0}, allora il corrispondente vincolo del duale attivo.
        \item Se un vincole del primale è attivo, allora la corrispondente variabile del duale è uguale a zero.
    \end{itemize}
    \item Pongo a sistema le equazioni che ho trovato, se il risultato è \textbf{ammissibile per il duale}, allora esso è l'ottimo del duale e il risultato in esame è l'ottimo del primale.
\end{enumerate}
\paragraph{I vincoli attivi} Un vincolo è attivo per una soluzione se applicando i valori delle variabili esso risulta \emph{rispettato all'uguaglianza}.
\\Per esempio, se ho una soluzione $(3,0,2)$, i vincoli:
\begin{itemize}
    \item $x_1 + 2x_2 +3x_3 \leq 9$ è attivo: $9 \leq 9$
    \item $x_1 + 2x_2 +x_3 \leq 7 $ NON è attivo: $ 7 \leq 9$
\end{itemize}
